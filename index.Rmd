---
title: "Gov 50 Final Project"
author: Ben Seklir
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---
```{r setup, include = FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)
```


## Introduction
In the realm of healthcare, the quality of care provided in nursing homes is a critical concern, particularly given the vulnerable population they serve. This project delves into a pivotal research question: "How does the ownership type of nursing homes affect their quality of care?" At the heart of this inquiry lies the hypothesis that nursing homes operated by for-profit organizations provide a lower quality of care than those compared to those managed by the government and non-profit entities. Understanding the impact of ownership on care quality can inform policy decisions, guide regulatory frameworks, and ultimately enhance the well-being of elderly residents. By scrutinizing the intersection between ownership type and care quality, this project aims to contribute to the ongoing discourse on optimizing healthcare in eldercare facilities. 



## Data
My data is sourced from the Centers for Medicaid & Medicare Services (CMS), which is a federal agency within the United States Department of Health and Human Services. CMS rigorously conducts inspections and maintains records for all nursing homes within the United States. I used the dataset titled "NH_ProviderInfo_Oct2023.csv", which is a list of 14,944 currently active nursing homes that includes both general information about the nursing home as well as its score across a number of quality metrics. My key independent variable is one that I created, titled `Umbrella`, which refers to the type of the organization that operates the nursing home. These organizations are categorized into government, non-profit, and for-profit. To create the `Umbrella` variable, I simplified the `Ownership Type` variable that CMS provided, which specified the exact nature of the nursing home's ownership, such as whether it was run by a for-profit corporation, individual, limited liability company, or partnership. These original detailed ownership types are typically identified through administrative records, business filings, or self-reported data by the nursing homes. By categorizing the specific types of ownership into broader groups, I could more easily investigate how these generalized ownership types relate to the overall rating of nursing homes. I felt that the overarching trends and patterns that I wanted to identify might be obscured by the granularity of the original `Ownership Type` variable. While `Umbrella` was my main predictor variable, I also analyzed how three other factors (state, facility size, and staffing levels) were associated with the overall quality rating of nursing homes. The `State` variable refers to the state in which the nursing home is located and is used as a categorical variable, with each state representing a category. The `Number of Certified Beds` is a continuous variable indicating the size of the nursing home, and is usually obtained from administrative records and regulatory filings of the nursing homes. Finally, `Reported Licensed Staffing Hours per Resident Per Day` is a continuous variable representing the staffing level, and is typically collected through mandatory reporting requirements. Licensed staffing refers to both registered nurses and licensed practical nurses. 

My key dependent variable is the `Overall Rating` of nursing homes. This variable is measured using CMS' "Five-Star Quality Rating System," which assigns a nursing home a rating between 1 and 5 stars, with more stars indicating higher quality. A nursing home's overall rating is an aggregate score based on the its ratings for health inspections, quality measures, and staffing, which are also rated on a scale ranging from 1 to 5 stars. The health inspection ratings are calculated from surveys over the past three years, with more recent surveys being weighted more heavily. The quality measure ratings are calculated from a nursing home's reported performance on 10 quality measures. The staffing measures are derived from third-party data. 

Below is a histogram that summarizes the distribution of the dependent variable.  
```{r}
ggplot(nursing_homes, aes(x = `Overall Rating`)) +
  geom_histogram(binwidth = 1, fill = "dodgerblue", color = "black") +
  labs(x = "Overall Rating", y = "Frequency", title = "Distribution of Overall Ratings of Nursing Homes")
```
The most common rating is 1, with 3,527 nursing homes receiving this score. There are 3,052 2-star nursing homes, 2,873 3-star ones, 2,639 4-star ones, and 2,699 5-star ones. The distribution of the overall ratings appears roughly uniform with a slight left skewness as indicated by the mean (2.86) being marginally lower than the median (3).


## Proposal

How does the ownership type of nursing homes affect their quality? I hypothesize that nursing homes operated by for-profit organizations provide worse quality of care than those operated by non-profit organizations and the government. As I started to get at in my initial project thoughts above, I suspect that the reason for this comes down to the incentives of the different ownership types. I would expect that for-profit nursing homes would be looking to minimize expenses wherever possible (to maximize profit) and that the quality of care would take a hit as a result. My data, sourced from the Centers for Medicaid & Medicare Services (CMS), is a list of currently active nursing homes that includes both general information about the nursing home as well as its score across a number of quality metrics. The explanatory variable of interest is whether the nursing home is operated by a for-profit organization or a non-profit organization/the government. The variable can be found under the column titled "Ownership Type". My outcome variable a nursing home's overall quality, which can be found under the "Overall Rating" column. This variable is measured using CMS' "Five-Star Quality Rating System," which assigns a nursing home an aggregate score based on the its ratings for health inspections, quality measures, and staffing, with more stars indicating higher quality. If I observe that non-profit- and government-operated nursing homes have higher average overall rating scores than for-profit facilities, this would provide support for my hypothesis. If it turns out that for-profit nursing homes have higher or similar average overall rating scores than non-profit- and government-operated facilities, this would provide evidence against my hypothesis.



## Data visualization

```{r}
nursing_homes <- read_csv("NH_ProviderInfo_Oct2023.csv")

nursing_homes <- nursing_homes |>
  mutate(Umbrella = case_when(
    `Ownership Type` %in% c("For profit - Corporation", "For profit - Individual", "For profit - Limited Liability company", "For profit - Partnership") ~ "For-profit",
    `Ownership Type` %in% c("Non profit - Corporation", "Non profit - Other", "Non profit - Church related") ~ "Non-profit",
    `Ownership Type` %in% c("Government - Federal", "Government - State", "Government - County", "Government - City/county", "Government - City", "Government - Hospital district") ~ "Government",
    TRUE ~ "Other"
  ))

selected_columns <-  nursing_homes |> select(c('Provider Name','Umbrella','Overall Rating'))

rating_table <- selected_columns |>
  group_by(Umbrella) |>
  summarize(
    avg_overall_rating = mean(`Overall Rating`, na.rm = TRUE)
  )
```

```{r}
ggplot(rating_table, aes(x = Umbrella, y = avg_overall_rating, fill = Umbrella)) +
  geom_col() +
  labs(x = "Ownership Type",
       y = "Average Overall Rating",
       title = "Average Overall Rating of Nursing Homes by Ownership Type")
```



## Analysis

```{r}
knitr::kable(
  rating_table,
  col.names = c("Umbrella", "Average Overall Rating")
)
```
The results reveal that, on average, nursing homes operated by for-profit organizations provide worse quality of care than those operated by non-profit organizations and the government. For-profit nursing homes received an average of 2.64/5 stars. Nursing homes operated by the government performed significantly better, receiving an average rating of 3.26/5, approximately 12.3% more stars than for-profit nursing homes received. Non-profit nursing homes performed the best of the three ownership types, receiving an average rating of 3.45/5 stars. 

```{r}
lm_model <- lm(`Overall Rating` ~ Umbrella + `State` + `Number of Certified Beds` + `Reported Licensed Staffing Hours per Resident per Day`, data = nursing_homes)
modelsummary::modelsummary(lm_model, statistic = c("s.e. = {std.error}",
                                                   "p = {p.value}"), gof_map = c("nobs", "r.squared", "adj.r.squared"))
```
```{r}
ggplot(nursing_homes, aes(x = `Overall Rating`)) +
  geom_histogram(binwidth = 1, fill = "dodgerblue", color = "black") +
  labs(x = "Overall Rating", y = "Frequency")
```


